<div class="fourversion_roulette">
  <div class="roulette-container">
    <div class="roulettewrapper">
      <div class= "foundation_roulettes">
        <div class="foundation_quarter" id="f_quarter_1">
          <h3 class="form1"><%= @form1 %></h3>
        </div>
        <div class="foundation_quarter" id="f_quarter_2">
          <h3 class="form2"><%= @form2 %></h3>
        </div>
        <div class="foundation_quarter" id="f_quarter_3">
          <h3 class="form3"><%= @form3 %></h3>
        </div>
        <div class="foundation_quarter" id="f_quarter_4">
          <h3 class="form4"><%= @form4 %></h3>
        </div>
      </div>
    </div>
    <div class="roulettewrapper_top">
      <div class= "top_roulettes" id="roulettes4">
        <div class="top_quarter" id="t_quarter_1">
          <h3 class="form5"><%= @form5 %></h3>
        </div>
        <div class="top_quarter" id="t_quarter_2">
          <h3 class="form6"><%= @form6 %></h3>
        </div>
        <div class="top_quarter" id="t_quarter_3">
          <h3 class="form7"><%= @form7 %></h3>
        </div>
        <div class="top_quarter" id="t_quarter_4">
          <h3 class="form8"><%= @form8 %></h3>
        </div>
      </div>
    </div>
    <%= form_with  class: "todoform", method: :get, scope: :formdate, local: true do |f| %>
      <table>
        <tbody>
          <% 1.step(7, 2) do |num| %>
            <tr>
              <td><%= f.text_field :task ,name:"formdate[form#{num}]", placeholder:"タスクを記入" %></td>
              <td><%= f.text_field :name ,name:"formdate[form#{num+1}]", placeholder: "名前を記入"%></td>
            </tr>
          <% end %>
        </tbody>
        <tfoot>
          <tr>
            <td ><button id="btn" type="button">追加</button></td>
          </tr>
        </tfoot>
      </table>
      <td ><%= f.submit "反映", class: "btn" %></td>
    <% end %>
    <%= form_with model: @tasks, url: tasks_path, class: "todolists", method: :post ,class: "todolist", local: true do |f| %>
        <%= fields_for 'tasks[]', @tasks do |f| %>
          <%= f.text_field :task ,name:"test", value: @form1  %>
          <%= f.text_field :name , value: @form5  %>
          <%= f.text_field :status , value: "todo"  %>
          <%= f.text_field :roulette_id , value: "4"  %>
        <% end%>
      <%= f.submit "ToDoリストを作成する", class: "btn_todo" %>
    <% end %>
    <div class="roulettebutton">
      <div class="tow_buttons">
        <input type="button" value="スタート", id= "start4", class= "myButton">
        <input type="button" value="ストップ", id= "stop4", class= "myButton">
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  const start = document.getElementById('start4');
  const stop = document.getElementById('stop4');
  const roulettes = document.getElementById('roulettes4');

  let degree = 0;
  let speed = 0;
  let move = false;

  start.addEventListener('click', () => {
    if(!move) {
      move = true;
      speed = 90;
      loop();
    }
  });

  stop.addEventListener('click', () => {
    if(move) {
      move = false;
    }
  });

  function loop() {
    degree += speed;
    if(move) {
      roulettes.style.transform = `rotate(${degree}deg)`;
      requestAnimationFrame(loop);
    }
  }

  $(function(){
    $("button#btn").click(function() {
        var tr_form = '' +
          '<tr>'+
          '<td><input type="text" class="task" placeholder= "タスクを記入" max= 5/></td>' +
          '<td><input type="text" class="task" placeholder= "名前を記入" max= 5/></td>' +
          '</tr>';
      $(tr_form).appendTo($('table > tbody'));
      var i = 9;
      $ ('.task').each(function(){
        $(this).attr('name','formdate[text'+ i +']' );
        i++;
      });
    });
  });
</script>
